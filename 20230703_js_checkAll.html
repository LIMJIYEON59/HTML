<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>전체선택</title>
    <style>
        .checkboxs {
            display: grid;
            /*옆으로 나타나게 해주는놈*/
            grid-template-columns: auto auto auto auto auto;
        }

        .checkedItems {
            border: 1px solid black;
            padding: 10px 20px;
            margin-top: 30px;
        }
    </style>
</head>

<body>
    <div>
        <label for="allcheck">전체선택 : </label>
        <input type="checkbox" id="allcheck">
        <label for="revCheck">반대선택 : </label>
        <input type="checkbox" id="revCheck">

    </div>
    <div class="checkboxs">
        <!-- <div>
            <label for="id-2">id-2 : </label>
            <input type="checkbox" id="id-2">
        </div> -->
    </div>
    <div class="checkedItems"> <!--선택해제를 누르면 체크박스가 삭제된다.-->
        <div><span>id-1</span>
            <input type="button" class="btnUncheck" value="선택해제">
        </div>
        <div>id-3</div>
    </div>
    <script>
        //1. 화면 itme 구성(화면 초기화?)
        const itemCnt = 10; //const 상수 = java의 final

        // ` <= 백틱 backtick : 문자열 형태 - 변수 사용시 ${변수명}
        var htmlVal = "";
        for (var i = 0; i < itemCnt; i++) {
            htmlVal += `
            <div>
                <lable for="id-${i}">id-${i} : </lable>
                <input type="checkbox" id="id-${i}" class="item">
            </div> 
                `;
        }
        $(".checkboxs").append(htmlVal);

        /* 2.전체선택 이벤트 등록*/
        $("#allCheck").on("click", allCheckHandler);
        /* 6. 반대선택 이벤트 등록*/
        $("#revCheck").on("click", revCheckHandler);

        /*11. 선택해제 이벤트 처리 handler */
        function btnUncheckHandler() {
            // console.log("btnUncheckHandler");
            console.log($(this).parent().data("id"));
            var id = $(this).parent().data("id");
            $(this).parent().remove();
            for(var i = 0; i < $(".checkboxs > div").length ; i++) {
                var $element = $(".checkboxs > div").eq(i)
                // var element = $(".checkboxs > div").get(i);
                var element_id = $element.data("id");
            }
        }

        /* 3.전체선택 이벤트 처리 Handler*/
        function allCheckHandler(e) {
            //console.log($(this).attr("checked"));     //attr()메소드는 동적페이지 변화인지되지 않음.
           
            //prop() 메소드는 동적페이지 변화를 인지하고 그 결과값을 true/false로 줌.
            var allchecked = $(this).prop("checked")

            consloe.log($(this).prop("checked"));       //prop는 properties의 약어 =속성 //attr은 잘 안 쓰고 얘를 쓴다.
            //checked는 값이 없기 때문에 true flase가 나온다.

            //현재 전체선택 상태 true / false =- item들에 적용
            $("item").prop("checked" , allchecked);

            /* 12. 전체선택 처리 후 checkedItems 에도 적용*/
        }
        /* 5. item 이벤트 처리 Handler */
        function itemCheckHandler(e) {
            // console.log($(this).prop("checked"));
            console.log($(".item:checked"));
            if (itemCnt == $(".item:checked").length) {
                $("#allCheck").prop("checked", true);
            } else {
                $("#allCheck").prop("checked", false);
            }

            /* 8.checkedItems에 선택된 item을 div로 생성*/
            if ($(this).prop("checked") == true) {
                console.log($(this).parent().data("id"));
                var dataid = $(this).parent().data("id");     //변수에 넣어준다.
                var htmlVal = "";
                htmlVal += `
                <div data-id= "${dataid}">
                    <span>${dataid}</span>
                    <button type="button" class="btnUncheck">선택해제"</button>
                </div>
                `;
                $(".checkedItems").append(htmlVal);
                /* 10. 선택해제 이벤트 등록 - 이시점에 등록해야함. appen 된 다음*/
                $(".btnUncheck").off("click");
            }
            /* 9.checkedItems에 선택된 item을 div로 부터 제거*/
            else {
                console.log$(this).parent().data("id");
                var dataid = $(this).parent().data("id");
                $(".checkedItems>div").each(function (idx, item) {
                    //console.log(item); =>전체를 한번만 돈다.
                    console.log($(item).data("id"));
                    if ($(item).data("id") == dataid) {
                        $(item).remove();
                        //each 반복문 (function)은 더 돌지 않고 마치고 싶을때 return;
                        // for문은 아니므로 breakk; 사용 불가.
                        return;
                    }
                })
            }
        }
        /* 7. 반대선택 이벤트 처리  Handler*/
        function revCheckHandler(e) {
            //반대선택 item들의 checked 상태의 반대 적용
            $(".item").each(function (idx, item) {
                //  console.log(idx);
                //  console.log(status);
                var status = $(item).prop("checked");
                $(item).prop("checked", !status); //반대값을 넣어준다.
            });

        }


    </script>
</body>

</html>